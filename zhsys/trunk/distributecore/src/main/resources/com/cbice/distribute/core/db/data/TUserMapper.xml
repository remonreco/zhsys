<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cbice.distribute.core.db.data.TUserMapper">
  <resultMap id="BaseResultMap" type="com.cbice.distribute.core.db.model.TUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="assets_account" jdbcType="VARCHAR" property="assetsAccount" />
    <result column="rights_account" jdbcType="VARCHAR" property="rightsAccount" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="tel" jdbcType="VARCHAR" property="tel" />
    <result column="address" jdbcType="VARCHAR" property="address" />
    <result column="agency_id" jdbcType="BIGINT" property="agencyId" />
    <result column="user_role_id" jdbcType="BIGINT" property="userRoleId" />
    <result column="account_status" jdbcType="INTEGER" property="accountStatus" />
    <result column="dealer_num" jdbcType="VARCHAR" property="dealerNum" />
    <result column="dealer_name" jdbcType="VARCHAR" property="dealerName" />
    <result column="user_identy" jdbcType="INTEGER" property="userIdenty" />
    <result column="email" jdbcType="VARCHAR" property="email" />
    <result column="sex" jdbcType="INTEGER" property="sex" />
    <result column="certificate_num" jdbcType="VARCHAR" property="certificateNum" />
    <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    id, assets_account, rights_account, user_name, tel, address, agency_id, user_role_id, 
    account_status, dealer_num, dealer_name, user_identy, email, sex, certificate_num, 
    modify_time
  </sql>
  <select id="selectByExample" parameterType="com.cbice.distribute.core.db.model.TUserExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from t_user
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_user
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    delete from t_user
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <delete id="deleteByExample" parameterType="com.cbice.distribute.core.db.model.TUserExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    delete from t_user
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.cbice.distribute.core.db.model.TUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    insert into t_user (id, assets_account, rights_account, 
      user_name, tel, address, 
      agency_id, user_role_id, account_status, 
      dealer_num, dealer_name, user_identy, 
      email, sex, certificate_num, 
      modify_time)
    values (#{id,jdbcType=BIGINT}, #{assetsAccount,jdbcType=VARCHAR}, #{rightsAccount,jdbcType=VARCHAR}, 
      #{userName,jdbcType=VARCHAR}, #{tel,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR}, 
      #{agencyId,jdbcType=BIGINT}, #{userRoleId,jdbcType=BIGINT}, #{accountStatus,jdbcType=INTEGER}, 
      #{dealerNum,jdbcType=VARCHAR}, #{dealerName,jdbcType=VARCHAR}, #{userIdenty,jdbcType=INTEGER}, 
      #{email,jdbcType=VARCHAR}, #{sex,jdbcType=INTEGER}, #{certificateNum,jdbcType=VARCHAR}, 
      #{modifyTime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.cbice.distribute.core.db.model.TUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    insert into t_user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="assetsAccount != null">
        assets_account,
      </if>
      <if test="rightsAccount != null">
        rights_account,
      </if>
      <if test="userName != null">
        user_name,
      </if>
      <if test="tel != null">
        tel,
      </if>
      <if test="address != null">
        address,
      </if>
      <if test="agencyId != null">
        agency_id,
      </if>
      <if test="userRoleId != null">
        user_role_id,
      </if>
      <if test="accountStatus != null">
        account_status,
      </if>
      <if test="dealerNum != null">
        dealer_num,
      </if>
      <if test="dealerName != null">
        dealer_name,
      </if>
      <if test="userIdenty != null">
        user_identy,
      </if>
      <if test="email != null">
        email,
      </if>
      <if test="sex != null">
        sex,
      </if>
      <if test="certificateNum != null">
        certificate_num,
      </if>
      <if test="modifyTime != null">
        modify_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=BIGINT},
      </if>
      <if test="assetsAccount != null">
        #{assetsAccount,jdbcType=VARCHAR},
      </if>
      <if test="rightsAccount != null">
        #{rightsAccount,jdbcType=VARCHAR},
      </if>
      <if test="userName != null">
        #{userName,jdbcType=VARCHAR},
      </if>
      <if test="tel != null">
        #{tel,jdbcType=VARCHAR},
      </if>
      <if test="address != null">
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="agencyId != null">
        #{agencyId,jdbcType=BIGINT},
      </if>
      <if test="userRoleId != null">
        #{userRoleId,jdbcType=BIGINT},
      </if>
      <if test="accountStatus != null">
        #{accountStatus,jdbcType=INTEGER},
      </if>
      <if test="dealerNum != null">
        #{dealerNum,jdbcType=VARCHAR},
      </if>
      <if test="dealerName != null">
        #{dealerName,jdbcType=VARCHAR},
      </if>
      <if test="userIdenty != null">
        #{userIdenty,jdbcType=INTEGER},
      </if>
      <if test="email != null">
        #{email,jdbcType=VARCHAR},
      </if>
      <if test="sex != null">
        #{sex,jdbcType=INTEGER},
      </if>
      <if test="certificateNum != null">
        #{certificateNum,jdbcType=VARCHAR},
      </if>
      <if test="modifyTime != null">
        #{modifyTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.cbice.distribute.core.db.model.TUserExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    select count(*) from t_user
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    update t_user
    <set>
      <if test="record.id != null">
        id = #{record.id,jdbcType=BIGINT},
      </if>
      <if test="record.assetsAccount != null">
        assets_account = #{record.assetsAccount,jdbcType=VARCHAR},
      </if>
      <if test="record.rightsAccount != null">
        rights_account = #{record.rightsAccount,jdbcType=VARCHAR},
      </if>
      <if test="record.userName != null">
        user_name = #{record.userName,jdbcType=VARCHAR},
      </if>
      <if test="record.tel != null">
        tel = #{record.tel,jdbcType=VARCHAR},
      </if>
      <if test="record.address != null">
        address = #{record.address,jdbcType=VARCHAR},
      </if>
      <if test="record.agencyId != null">
        agency_id = #{record.agencyId,jdbcType=BIGINT},
      </if>
      <if test="record.userRoleId != null">
        user_role_id = #{record.userRoleId,jdbcType=BIGINT},
      </if>
      <if test="record.accountStatus != null">
        account_status = #{record.accountStatus,jdbcType=INTEGER},
      </if>
      <if test="record.dealerNum != null">
        dealer_num = #{record.dealerNum,jdbcType=VARCHAR},
      </if>
      <if test="record.dealerName != null">
        dealer_name = #{record.dealerName,jdbcType=VARCHAR},
      </if>
      <if test="record.userIdenty != null">
        user_identy = #{record.userIdenty,jdbcType=INTEGER},
      </if>
      <if test="record.email != null">
        email = #{record.email,jdbcType=VARCHAR},
      </if>
      <if test="record.sex != null">
        sex = #{record.sex,jdbcType=INTEGER},
      </if>
      <if test="record.certificateNum != null">
        certificate_num = #{record.certificateNum,jdbcType=VARCHAR},
      </if>
      <if test="record.modifyTime != null">
        modify_time = #{record.modifyTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    update t_user
    set id = #{record.id,jdbcType=BIGINT},
      assets_account = #{record.assetsAccount,jdbcType=VARCHAR},
      rights_account = #{record.rightsAccount,jdbcType=VARCHAR},
      user_name = #{record.userName,jdbcType=VARCHAR},
      tel = #{record.tel,jdbcType=VARCHAR},
      address = #{record.address,jdbcType=VARCHAR},
      agency_id = #{record.agencyId,jdbcType=BIGINT},
      user_role_id = #{record.userRoleId,jdbcType=BIGINT},
      account_status = #{record.accountStatus,jdbcType=INTEGER},
      dealer_num = #{record.dealerNum,jdbcType=VARCHAR},
      dealer_name = #{record.dealerName,jdbcType=VARCHAR},
      user_identy = #{record.userIdenty,jdbcType=INTEGER},
      email = #{record.email,jdbcType=VARCHAR},
      sex = #{record.sex,jdbcType=INTEGER},
      certificate_num = #{record.certificateNum,jdbcType=VARCHAR},
      modify_time = #{record.modifyTime,jdbcType=TIMESTAMP}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.cbice.distribute.core.db.model.TUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    update t_user
    <set>
      <if test="assetsAccount != null">
        assets_account = #{assetsAccount,jdbcType=VARCHAR},
      </if>
      <if test="rightsAccount != null">
        rights_account = #{rightsAccount,jdbcType=VARCHAR},
      </if>
      <if test="userName != null">
        user_name = #{userName,jdbcType=VARCHAR},
      </if>
      <if test="tel != null">
        tel = #{tel,jdbcType=VARCHAR},
      </if>
      <if test="address != null">
        address = #{address,jdbcType=VARCHAR},
      </if>
      <if test="agencyId != null">
        agency_id = #{agencyId,jdbcType=BIGINT},
      </if>
      <if test="userRoleId != null">
        user_role_id = #{userRoleId,jdbcType=BIGINT},
      </if>
      <if test="accountStatus != null">
        account_status = #{accountStatus,jdbcType=INTEGER},
      </if>
      <if test="dealerNum != null">
        dealer_num = #{dealerNum,jdbcType=VARCHAR},
      </if>
      <if test="dealerName != null">
        dealer_name = #{dealerName,jdbcType=VARCHAR},
      </if>
      <if test="userIdenty != null">
        user_identy = #{userIdenty,jdbcType=INTEGER},
      </if>
      <if test="email != null">
        email = #{email,jdbcType=VARCHAR},
      </if>
      <if test="sex != null">
        sex = #{sex,jdbcType=INTEGER},
      </if>
      <if test="certificateNum != null">
        certificate_num = #{certificateNum,jdbcType=VARCHAR},
      </if>
      <if test="modifyTime != null">
        modify_time = #{modifyTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cbice.distribute.core.db.model.TUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Mar 20 16:30:23 CST 2015.
    -->
    update t_user
    set assets_account = #{assetsAccount,jdbcType=VARCHAR},
      rights_account = #{rightsAccount,jdbcType=VARCHAR},
      user_name = #{userName,jdbcType=VARCHAR},
      tel = #{tel,jdbcType=VARCHAR},
      address = #{address,jdbcType=VARCHAR},
      agency_id = #{agencyId,jdbcType=BIGINT},
      user_role_id = #{userRoleId,jdbcType=BIGINT},
      account_status = #{accountStatus,jdbcType=INTEGER},
      dealer_num = #{dealerNum,jdbcType=VARCHAR},
      dealer_name = #{dealerName,jdbcType=VARCHAR},
      user_identy = #{userIdenty,jdbcType=INTEGER},
      email = #{email,jdbcType=VARCHAR},
      sex = #{sex,jdbcType=INTEGER},
      certificate_num = #{certificateNum,jdbcType=VARCHAR},
      modify_time = #{modifyTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=BIGINT}
  </update>
  
  <select id="selectDealerAgency" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">

  select * from t_agency ta1 inner join t_agency ta2 on ta1.id=ta2.higer_dealer_id   left join t_user tu on tu.agency_id=ta1.id and tu.user_identy='1'
  
  <if test="agencyId!=null and agencyId!=''">
  and tu.agency_id=#{agencyId}
  </if>    

  <if test="dealerNum != null and dealerNum !=''">
  and tu.dealer_num like concat(concat('%', #{dealerNum}), '%')
      </if>
      <if test="dealerName != null and dealerName !=''">
  and tu.dealer_name like concat(concat('%', #{dealerName}), '%')
      </if>
    <if test="limit != null">limit #{limit}</if>
    <if test="start != null">offset #{start}</if>    
  </select>
  

  <!-- distributemgr   'ICE' -->
  <select id="selectDealer" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
  select distinct ta1.* from t_agency ta1 inner join t_agency ta2 on ta1.id=ta2.higer_dealer_id   left join t_user tu on tu.agency_id=ta1.id and tu.user_identy='1' and ta1.dealer_level='1'
 
 <if test="agencyId!=null and agencyId!=''">
  and tu.agency_id=#{agencyId}
  </if>
 
  <if test="dealerNum != null and dealerNum !=''">
  and dealer_num like concat(concat('%', #{dealerNum}), '%')
      </if>
      <if test="dealerName != null and dealerName !=''">
  and dealer_name like concat(concat('%', #{dealerName}), '%')
      </if>
    <if test="limit != null">limit #{limit}</if>
    <if test="start != null">offset #{start}</if>    
  </select>
  
   <select id="selectDealerUser" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
   	   select distinct * from t_user where user_identy='0'
	  <if test="agencyId != null and agencyId !=''">
	  	and agency_id =#{agencyId} 
	  </if>
	  <if test="userName != null and userName !=''">
	  	and user_name like concat('%', #{userName}, '%')
	  </if>
	   <if test="assetsAccount != null and assetsAccount !=''">
	  	and assets_account =#{assetsAccount} 
	  </if>
	  <if test="tel != null and tel !=''">
	  	and tel =#{tel}
	  </if>
	  ORDER BY id desc
	  <if test="limit != null">limit #{limit}</if>
	  <if test="start != null">offset #{start}</if>    
  </select>
  

  <!-- distributeagency-->

   <select id="countSelectDealerAgency" parameterType="com.cbice.distribute.core.db.model.TUser" resultType="int">
select count (1) from (

  select * from t_agency ta1 inner join t_agency ta2 on ta1.id=ta2.higer_dealer_id   left join t_user tu on tu.agency_id=ta1.id and tu.user_identy='1'


  <if test="agencyId!=null and agencyId!=''">
  and tu.agency_id=#{agencyId}
  </if> 

  
  <if test="dealerNum != null and dealerNum !=''">
  and tu.dealer_num like concat(concat('%', #{dealerNum}), '%')
      </if>
      <if test="dealerName != null and dealerName !=''">
  and tu.dealer_name like concat(concat('%', #{dealerName}), '%')
      </if>
) a
  </select>
  
   <select id="countSelectDealer" parameterType="com.cbice.distribute.core.db.model.TUser" resultType="int">
select count (1) from (
select distinct ta1.* from t_agency ta1 inner join t_agency ta2 on ta1.id=ta2.higer_dealer_id   left join t_user tu on tu.agency_id=ta1.id and tu.user_identy='1' and ta1.dealer_level='1'
 
 <if test="agencyId!=null and agencyId!=''">
  and tu.agency_id=#{agencyId}
  </if>
  <if test="dealerNum != null and dealerNum !=''">
  and dealer_num like concat(concat('%', #{dealerNum}), '%')
      </if>
      <if test="dealerName != null and dealerName !=''">
  and dealer_name like concat(concat('%', #{dealerName}), '%')
      </if>
) a
  </select>
  
  <select id="selectTuserBydealerNumAndName" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
  
  select * from t_user 
  
   <trim prefix="where" prefixOverrides="and">
        <if test="dealerNum != null and dealerNum !=''">
   and dealer_num = #{dealerNum,jdbcType=VARCHAR}
      </if>
      <if test="dealerName != null and dealerName !=''">
   and dealer_name = #{dealerName,jdbcType=VARCHAR}
      </if>
       <if test="id != null">
   	and id  <![CDATA[<>]]> #{id}
      </if>
    </trim>
  </select>
  
   <select id="selectTuserBydUserNumAndName" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
  
  select * from t_user 
  
   <trim prefix="where" prefixOverrides="and">
        <if test="assetsAccount != null and assetsAccount !=''">
   and assets_account = #{assetsAccount,jdbcType=VARCHAR}
      </if>
      <if test="rightsAccount != null and rightsAccount !=''">
   and rights_account = #{rightsAccount,jdbcType=VARCHAR}
      </if>
      <if test="id != null">
   	and id  <![CDATA[<>]]> #{id}
      </if>
    </trim>
  </select>
  
  <select id="selectLowerDealer" parameterType="map" resultMap="BaseResultMap">
  select distinct * from t_user  where  agency_id = #{higerDealer} order by user_identy DESC
    <if test="limit != null">limit #{limit}</if>
    <if test="start != null">offset #{start}</if>
  </select>
  
  <select id="countselectLowerDealer" parameterType="map" resultType="int">
  select count(1) from 
  (  select distinct * from t_user  where  agency_id = #{higerDealer}
    <if test="limit != null">limit #{limit}</if>
    <if test="start != null">offset #{start}</if>
  ) a
  
  </select>
  
  
     <select id="countByCondition" parameterType="map" resultType="int">
    select count(distinct a.*)
    from t_user a left join t_agency_user_busi_role b on a.id = b.user_id  <trim prefix="where" prefixOverrides="and">
    <if test="status != null">
        and a.account_status = #{status}
    </if>
    <if test="agency_Id != null">
        and a.agency_id = #{agency_Id}
    </if>
    <if test="user_identy != null">
        and a.user_identy = #{user_identy}
    </if>
    <if test="roles != null and roles.size() &gt; 0">and b.busi_role_id in
    <foreach close=")" collection="roles" item="item" open="(" separator=",">
        #{item}
    </foreach>
    </if>
    <if test="loginName != null">and a.dealer_name like concat('%', #{loginName}, '%')</if> </trim>
  </select>
  <select id="selectByCondition" parameterType="map" resultMap="BaseResultMap">
    select distinct a.* from t_user a left join t_agency_user_busi_role b on a.id = b.user_id 
    <trim prefix="where" prefixOverrides="and">
        <if test="status != null">
            and a.account_status = #{status}
        </if>
        <if test="agency_Id != null">
        and a.agency_id = #{agency_Id}
    </if>
    <if test="user_identy != null">
        and a.user_identy = #{user_identy}
    </if>
        <if test="roles != null and roles.size() &gt; 0">and b.busi_role_id in
        <foreach close=")" collection="roles" item="item" open="(" separator=",">
            #{item}
        </foreach>
        </if>
        <if test="loginName != null">and a.dealer_name like concat('%', #{loginName}, '%')</if>
    </trim>
    ORDER BY a.dealer_name
    <if test="limit != null">limit #{limit}</if>
    <if test="start != null">offset #{start}</if>
  </select> 
    
  <select id="selectDealer2" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
  	select distinct a.*,b.dealer_name as tdealername,b.dealer_level as tDealerLevel
  	from t_user a left join t_agency b on a.agency_id = b.id
  	where 1=1
  	<if test="userIdenty != null">
  		and user_identy = #{userIdenty}
	</if>
    <if test="assetsAccount != null and assetsAccount !=''">
  		and assets_account = #{assetsAccount}
	</if>
    <if test="userName != null and userName !=''">
  		and user_name like concat(concat('%', #{userName}), '%')
    </if>
    <if test="tel != null and tel !=''">
	  	and tel =#{tel}
	</if>
		ORDER BY modify_time desc
    <if test="limit != null">limit #{limit}</if>
    <if test="start != null">offset #{start}</if>    
  </select>
  
  
  <select id="countSelectDealer2" parameterType="com.cbice.distribute.core.db.model.TUser" resultType="int">
     select count (1) from (
     select distinct * from t_user where user_identy='0'
      <if test="agencyId != null and agencyId !=''">
	  	and agency_id =#{agencyId} 
     </if>
     <if test="assetsAccount != null and assetsAccount !=''">
        and assets_account = #{assetsAccount}
     </if>
     <if test="userName != null and userName !=''">
         and user_name like concat(concat('%', #{userName}), '%')
     </if>
     <if test="tel != null and tel !=''">
	  	and tel =#{tel}
	 </if> 
) a
  </select>
  
  
     <select id="selectLowerList" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
	  select * from t_user where 1=1
	 <if test="userId != null">
	  and id = #{userId}
	  union
	  select * from t_user where
	  user_identy =1 
	  and agency_id =#{userId}    
	  </if>
	  </select>
  
  
  <select id="selectUserAndTest" resultMap="BaseResultMap">
  select * from t_user where user_identy =0
  </select>
  
  <select id="selectAllToConvert" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
  select dealer_num,assets_account from (
  select distinct dealer_num ,assets_account from t_user where 1=1
  	<if test="assetsAccount != null and assetsAccount !=''">
  		and assets_account = #{assetsAccount}
	</if>
    <if test="userName != null and userName !=''">
  		and user_name like concat(concat('%', #{userName}), '%')
    </if>
    <if test="tel != null and tel !=''">
	  	and tel =#{tel}
	</if>
	<if test="certificateNum != null and tel !=''">
	  	and certificate_num =#{certificateNum}
	</if>
) a
  </select>
  
  
   <update id="updatePwdByAss" parameterType="com.cbice.distribute.core.db.model.TUser" >
    update t_user
    <set>
      <if test="dealerNum != null">
        dealer_num = #{dealerNum,jdbcType=VARCHAR},
      </if>
    </set>
    where assets_account = #{assetsAccount,jdbcType=VARCHAR}
  </update>
  

 
 <select id="selectConvertLogin" parameterType="com.cbice.distribute.core.db.model.TUser" resultMap="BaseResultMap">
  select user_name,id from (
  select distinct id,dealer_num ,user_name from t_user where 1=1
  	<if test="assetsAccount != null and assetsAccount !=''">
  		and assets_account = #{assetsAccount}
	</if>
    <if test="dealerNum != null and dealerNum !=''">
  		and dealer_num =#{dealerNum}
    </if>
) a
  </select> 
  
</mapper>